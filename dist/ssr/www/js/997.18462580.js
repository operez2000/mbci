"use strict";(self["webpackChunkmbci"]=self["webpackChunkmbci"]||[]).push([[997],{78098:(e,o,l)=>{l.d(o,{Z:()=>a});l(24110);const a={data(){return{txtSingular:"Cliente",txtPlural:"Clientes",id:"",nombreCompleto:"",email:"",telefono1:"",pais:"us",rulesId:[e=>!!e||"Campo obligatorio"],rules:[e=>!!e||"Campo obligatorio",e=>(e||"").length<=25||"Máximo 25 caractéres"],loading:!0,search:"",columns:[{name:"numero",field:"id",label:"Número",sortable:!0,align:"center"},{name:"nombreCompleto",field:"nombreCompleto",label:"Nombre del Cliente",sortable:!0,align:"left"},{name:"email",field:"email",label:"E-mail",sortable:!0,align:"left"},{name:"telefono1",field:"telefono1",label:"Teléfono",sortable:!0,align:"left"},{name:"pais",field:"pais",label:"País",sortable:!0,align:"left"}],rows:[],initialPagination:{sortBy:"nombre",descending:!1,page:1,rowsPerPage:15},dlgEditar:!1,nuevoRegistro:!1,frmValid:!1,loadingSave:!1,loadingDelete:!1,loadingId:!1,found:!1,error:!1,errorMessage:""}},mounted(){this.getRecords(),this.$axios({method:"get",url:"api/perfiles"}).then((e=>{this.perfiles=e.data.results})).catch((e=>{console.log("err",e)}))},computed:{computedError(){return 0==this.nombreCompleto.length?(this.errorMessage="Campo obligatorio",!0):this.found?(this.errorMessage=`El ${this.txtSingular} ya existe"`,!0):(this.errorMessage="",!1)}},methods:{getRecords(){this.loading=!0,this.$axios({url:`/api/${this.txtPlural.toLowerCase()}`,method:"get"}).then((e=>{404==e.data.result?this.$q.notify({color:"warning",message:"Se detectó un inconveniente con la Base de Datos"}):200==e.data.result&&(this.rows=e.data.results)})).catch((e=>{console.log("Error al leer los registros",e),this.$q.notify({color:"warning",message:"Se detectó un inconveniente con la Base de Datos "+e})})).finally((()=>{this.loading=!1}))},onRowClick(e,o){this.id=o.id,this.nombreCompleto=o.nombreCompleto,this.email=o.email,this.telefono1=o.telefono1,this.pais=o.pais,this.nuevoRegistro=!1,this.dlgEditar=!0},buscaRegistro(){if(this.found=!1,this.nombreCompleto.length>0){let e=!1;this.loadingId=!0,this.$axios({method:"get",url:`/api/${this.txtPlural.toLowerCase()}/${this.id}`}).then((o=>{200==o.data.result?(e=!0,this.found=!0):404==o.data.result&&this.$q.notify({color:"orange-10",message:"Se detectó un inconveniente con la Base de Datos"})})).catch((e=>{console.log("Error al leer los registros",e),this.$q.notify({color:"orange-10",message:"Se detectó un inconveniente con la Base de Datos: "+e})})).finally((()=>{this.loadingId=!1,this.found=e}))}},onSubmit(){this.$refs.frmRegistro.validate().then((e=>{e?(this.loadingSave=!0,this.loading=!0,this.$axios({method:"post",url:`/api/${this.txtSingular.toLowerCase()}`,data:{id:this.id,nombreCompleto:this.nombreCompleto,email:this.email,telefono1:this.telefono1,pais:this.pais,nuevoRegistro:this.nuevoRegistro}}).then((e=>{200==e.data.result?this.$q.notify({color:"positive",message:"Registro guardado correctamente"}):404==e.data.result&&this.$q.notify({color:"error",message:"Se detectó un inconveniente con la Base de Datos "+e.data.msg})})).catch((e=>{console.log("Error al actualizar el registro",e)})).finally((()=>{this.dlgEditar=!1,this.loading=!1,this.nuevoRegistro=!1,this.loadingSave=!1,this.getRecords()}))):this.$q.notify({color:"error",message:"No se ha capturado correctamente la información"})}))},onReset(){},agregaRegistro(){this.$refs.frmRegistro&&this.$refs.frmRegistro.resetValidation(),this.id="",this.nombreCompleto="",this.email="",this.telefono1="",this.pais="us"},borrarRegistro(){this.$q.dialog({title:this.nombreCompleto,message:"El registro se eliminará definitivamente",cancel:!0,persistent:!0,cancel:{label:"Regresar",color:"white",textColor:"primary",flat:!0}}).onOk((()=>{this.loadingDelete=!0,this.$axios({method:"delete",url:`/api/cliente/${this.id}`}).then((e=>{this.$q.notify({message:e.data.msg,color:"positive"}),this.dlgEditar=!1})).catch((e=>{this.$q.notify({message:e,color:"negative"})})).finally((()=>{let e=this.rows.findIndex((e=>e.id==this.id));this.rows.splice(e,1),this.loadingDelete=!1}))})).onCancel((()=>{}))}}}},27999:(e,o,l)=>{l.d(o,{s:()=>R});var a=l(59835),t=l(86970);const i={class:"absolute-center"},s={class:"text-subtitle1"},r={class:"text-h6 text-light-blue-2"},n={class:"row"},d={class:"col-4"},m={class:"row"},c={class:"col-12"},u={class:"row"},g={class:"col-8"},h={class:"col-4"},p={class:"row"},f={class:"col-12 q-gutter-md"},b={class:"row justify-between q-mt-md"},w={class:"col-3"},v={class:"col-3"},C={class:"col-auto"};function R(e,o,l,R,q,V){const $=(0,a.up)("q-space"),x=(0,a.up)("q-icon"),_=(0,a.up)("q-input"),y=(0,a.up)("q-tooltip"),W=(0,a.up)("q-btn"),S=(0,a.up)("q-table"),k=(0,a.up)("q-card-section"),Z=(0,a.up)("q-radio"),E=(0,a.up)("q-separator"),Q=(0,a.up)("q-form"),I=(0,a.up)("q-card"),U=(0,a.up)("q-dialog"),D=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(D,{class:"flex column"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(S,{class:"q-ma-sm",rows:q.rows,columns:q.columns,"row-key":"id",loading:q.loading,filter:q.search,dense:"",pagination:q.initialPagination,onRowClick:V.onRowClick},{top:(0,a.w5)((()=>[(0,a._)("span",s,(0,t.zw)(`${q.txtPlural}: ${(new Intl.NumberFormat).format(q.rows.length)}`),1),(0,a.Wm)($),(0,a.Wm)(_,{dense:"",debounce:"300",modelValue:q.search,"onUpdate:modelValue":o[0]||(o[0]=e=>q.search=e),placeholder:"Buscar"},{append:(0,a.w5)((()=>[(0,a.Wm)(x,{name:"search"})])),_:1},8,["modelValue"]),(0,a.Wm)($),(0,a.Wm)(W,{class:"q-mt-sm",round:"",color:"positive",icon:"mdi-plus",size:"sm",onClick:o[1]||(o[1]=e=>{q.nuevoRegistro=!0,q.dlgEditar=!0,V.agregaRegistro()})},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{anchor:"top middle",self:"bottom middle"},{default:(0,a.w5)((()=>[(0,a.Uk)("Agregar "+(0,t.zw)(q.txtSingular),1)])),_:1})])),_:1})])),_:1},8,["rows","columns","loading","filter","pagination","onRowClick"])]),(0,a.Wm)(U,{modelValue:q.dlgEditar,"onUpdate:modelValue":o[12]||(o[12]=e=>q.dlgEditar=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{class:(0,t.C_)(e.$q.dark.mode?"bg-dark":""),style:{"max-width":"6200px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"bg-primary"},{default:(0,a.w5)((()=>[(0,a._)("div",r,"Información del "+(0,t.zw)(q.txtSingular),1)])),_:1}),(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Q,{modelValue:q.frmValid,"onUpdate:modelValue":o[11]||(o[11]=e=>q.frmValid=e),onSubmit:V.onSubmit,onReset:V.onReset,class:"q-gutter-md",ref:"frmRegistro"},{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a._)("div",d,[(0,a.Wm)(_,{modelValue:q.id,"onUpdate:modelValue":o[2]||(o[2]=e=>q.id=e),label:"Número",color:"blue-6",outlined:"",mask:"#######","fill-mask":"0","reverse-fill-mask":"",readonly:!0},null,8,["modelValue"])])]),(0,a._)("div",m,[(0,a._)("div",c,[(0,a.Wm)(_,{modelValue:q.nombreCompleto,"onUpdate:modelValue":o[3]||(o[3]=e=>q.nombreCompleto=e),class:"q-mr-md",label:"Nombre del Cliente",color:"blue-6",debounce:"400",loading:q.loadingId,onInput:o[4]||(o[4]=e=>V.buscaRegistro()),error:V.computedError,"error-message":q.errorMessage,autofocus:""},null,8,["modelValue","loading","error","error-message"])])]),(0,a._)("div",u,[(0,a._)("div",g,[(0,a.Wm)(_,{modelValue:q.email,"onUpdate:modelValue":o[5]||(o[5]=e=>q.email=e),class:"q-mr-md",color:"info",label:"Email",rules:[e=>!e||/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)||"Cuenta de correo incorrecta"]},null,8,["modelValue","rules"])]),(0,a._)("div",h,[(0,a.Wm)(_,{modelValue:q.telefono1,"onUpdate:modelValue":o[6]||(o[6]=e=>q.telefono1=e),color:"info",label:"Teléfono",maxlength:"15",mask:"(###) ###-####"},null,8,["modelValue"])])]),(0,a._)("div",p,[(0,a._)("div",f,[(0,a.Wm)(Z,{modelValue:q.pais,"onUpdate:modelValue":o[7]||(o[7]=e=>q.pais=e),val:"us",label:"US +1"},null,8,["modelValue"]),(0,a.Wm)(Z,{modelValue:q.pais,"onUpdate:modelValue":o[8]||(o[8]=e=>q.pais=e),val:"mx",label:"México +52"},null,8,["modelValue"])])]),(0,a.Wm)(E),(0,a._)("div",b,[(0,a._)("div",w,[(0,a.Wm)(W,{label:"Regresar",onClick:o[9]||(o[9]=e=>q.dlgEditar=!1),"no-caps":""})]),(0,a._)("div",v,[(0,a.Wm)(W,{label:"Borrar",color:"negative","no-caps":"",disable:q.nuevoRegistro,onClick:o[10]||(o[10]=e=>V.borrarRegistro()),loading:q.loadingDelete},null,8,["disable","loading"])]),(0,a._)("div",C,[(0,a.Wm)(W,{type:"submit",label:"Guardar",color:"primary","no-caps":""})])])])),_:1},8,["modelValue","onSubmit","onReset"])])),_:1})])),_:1},8,["class"])])),_:1},8,["modelValue"])])),_:1})}},28997:(e,o,l)=>{l.r(o),l.d(o,{default:()=>q});var a=l(201),t=l(12797),i=l(11639),s=l(30718),r=l(56442),n=l(7358),d=l(3898),m=l(79968),c=l(49480),u=l(99675),g=l(80447),h=l(84498),p=l(56597),f=l(61451),b=l(79771),w=l(94935),v=l(69984),C=l.n(v);const R=(0,i.Z)(t.Z,[["render",a.s]]),q=R;C()(t.Z,"components",{QPage:s.Z,QTable:r.Z,QSpace:n.Z,QInput:d.Z,QIcon:m.Z,QBtn:c.Z,QTooltip:u.Z,QDialog:g.Z,QCard:h.Z,QCardSection:p.Z,QForm:f.Z,QRadio:b.Z,QSeparator:w.Z})},12797:(e,o,l)=>{l.d(o,{Z:()=>a.Z});var a=l(78098)},201:(e,o,l)=>{l.d(o,{s:()=>a.s});var a=l(27999)}}]);